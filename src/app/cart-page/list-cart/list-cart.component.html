<div class="container-80 dp-block-1-2 cart-page">
  <h1>Your Purchase Menu</h1>
  <!-- Pending -->
  <mat-accordion class="mr-bottom-1">
    <mat-expansion-panel
      (opened)="panelOpenState = true"
      (closed)="panelOpenState = true"
      [expanded]="true"
    >
      <mat-expansion-panel-header>
        <mat-panel-title> Pending </mat-panel-title>
        <mat-panel-description>
          Your Transaction Is Still in Process
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="list-item" *ngIf="pendingCart > 0; else pendingNotice">
        <div *ngFor="let item of cartListPending">
          <div *ngFor="let order of item?.menu; let j = index">
            <div class="item mr-bottom-1 mr-top-1">
              <img src="{{ order?.recipe_id?.image }}" alt="menu image" />
              <div class="item-detail">
                <h3>{{ order?.recipe_id?.recipe_name | titlecase }}</h3>
                <p>Rp {{ order?.recipe_id?.price }}</p>
                <p><b>note</b> : {{order?.note}}</p>
              </div>
              <div class="amount">
                <h4>Amount</h4>
                <div class="item-amount">
                  <button matSuffix mat-icon-button [ngStyle]="{ color: 'blue' }" matTooltip="minus" (click)="minAmount(order?._id)">
                    <mat-icon>remove</mat-icon>
                  </button>
                  <span>{{order.amount}}</span>
                  <!-- <input matInput disabled formGroupName="amount" value="0"/> -->
                  <button matSuffix mat-icon-button [ngStyle]="{ color: 'blue' }" matTooltip="plus" (click)="addAmount(order?._id)">
                    <mat-icon>add</mat-icon>
                  </button>
                </div>
              </div>
              <div class="item-total">
                <h4>Total Price</h4>
                <h1>Rp {{ item.total }}</h1>
              </div>
                <div class="order-button">
                    <button mat-flat-button color="primary" matTooltip="Order" (click)="orderBuy(item?.id)">
                        Order Now
                    </button>
                    <button mat-flat-button color="edit" matTooltip="Edit Note" (click)="editCartDialog(item?.id, order?._id)">
                      <mat-icon>edit</mat-icon>
                  </button>
                    <button mat-flat-button color="warn" matTooltip="Delete" (click)="deleteCart(item.id, order?.recipe_id?.recipe_name)">
                        <mat-icon>delete</mat-icon>
                    </button>
                </div>
            </div>
            <mat-divider></mat-divider>
          </div>
        </div>
      </div>
      <ng-template #pendingNotice>
        <h1>No Pending Transaction</h1>
      </ng-template>
    </mat-expansion-panel>
  </mat-accordion>
  <mat-paginator
    class="mr-bottom-2"
    [length]="pendingCart"
    [pageSizeOptions]="[10]"
    [pageSize]="pagination?.limit" 
    [pageIndex]="pagination?.page-1"
    (page)="handlePagePending($event)"
  ></mat-paginator>
  <!-- Success -->
  <mat-accordion class="mr-bottom-1">
    <mat-expansion-panel
      (opened)="panelOpenState = true"
      (closed)="panelOpenState = false"
      [expanded]="true"
    >
      <mat-expansion-panel-header>
        <mat-panel-title> Success </mat-panel-title>
        <mat-panel-description> Your Transaction Is Success </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="list-item" *ngIf="successCart > 0; else successNotice">
        <div *ngFor="let item of cartListSuccess">
          <div *ngFor="let order of item?.menu">
            <div class="item mr-bottom-1 mr-top-1">
              <img src="{{ order.recipe_id.image }}" alt="menu image" />
              <div class="item-detail">
                <h3>{{ order.recipe_id.recipe_name | titlecase }}</h3>
                <p>Rp {{ order.recipe_id.price }}</p>
              </div>
              <div class="amount">
                <h4>Amount</h4>
                <div class="item-amount">
                  <span>{{order.amount}}</span>
                </div>
              </div>
              <div class="item-total">
                <h4>Total Price</h4>
                <h1>Rp {{ item.total }}</h1>
              </div>
              <div class="item-status">
                <h4>Status</h4>
                <mat-icon matSuffix
                aria-label="Success"
                [ngStyle]="{ color: 'green' }">done_all</mat-icon>
              </div>
            </div>
            <mat-divider></mat-divider>
          </div>
        </div>
      </div>
      <ng-template #successNotice>
        <h1>No Success Transaction</h1>
      </ng-template>
    </mat-expansion-panel>
  </mat-accordion>
  <mat-paginator class="mr-bottom-2"
    [length]="successCart"
    [pageSizeOptions]="[10]"
    [pageSize]="pagination?.limit" 
    [pageIndex]="pagination?.page-1"
    (page)="handlePageSuccess($event)"></mat-paginator>
  <!-- Failed -->
  <mat-accordion>
    <mat-expansion-panel
      (opened)="panelOpenState = true"
      (closed)="panelOpenState = false"
      [expanded]="true"
    >
      <mat-expansion-panel-header>
        <mat-panel-title> Failed </mat-panel-title>
        <mat-panel-description>
          Your Transaction is Failed
        </mat-panel-description>
      </mat-expansion-panel-header>
      <div class="list-item" *ngIf="failedCart > 1 || failedCart != undefined || failedCart != null; else failedNotice">
        <div *ngFor="let item of cartListFailed">
          <div *ngFor="let order of item?.menu">
            <div class="item mr-bottom-1 mr-top-1">
              <img src="{{ order.recipe_id.image }}" alt="menu image" />
              <div class="item-detail">
                <h3>{{ order.recipe_id.recipe_name | titlecase }}</h3>
                <p>Rp {{ order.recipe_id.price }}</p>
              </div>
              <div class="amount">
                <h4>Amount</h4>
                <div class="item-amount">
                  <span>{{order.amount}}</span>
                </div>
              </div>
              <div class="item-total">
                <h4>Total Price</h4>
                <h1>Rp {{ item.total }}</h1>
              </div>
              <div class="item-status">
                <h4>Status</h4>
                <mat-icon matSuffix
                aria-label="Failed"
                [ngStyle]="{ color: 'red' }">clear</mat-icon>
              </div>
            </div>
            <mat-divider></mat-divider>
          </div>
        </div>
      </div>
      <ng-template #failedNotice>
        <h1>No Transaction Failed</h1>
      </ng-template>
    </mat-expansion-panel>
    <mat-paginator></mat-paginator>
  </mat-accordion>
</div>
